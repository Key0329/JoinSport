import{G as V,_ as P,r as b,o as a,a as r,b as i,J as l,d as n,B as d,D as m,z as T,A as w}from"./index-5ea3d25b.js";import{u as N,r as p}from"./i18n-validators-4caf0a3e.js";import{c as M}from"./createSteps-462bb92f.js";const{VITE_URL:D}={VITE_URL:"https://join-sport-server-vercel.vercel.app",VITE_PATH:"key0329",VITE_TEXT:"這是產品的環境",VITE_MAP_KEY:"AIzaSyAScKOJBsEFvLrg4YGx5ticXsBzFYZPATw",VITE_MAP_URL:"https://maps.googleapis.com/maps/api/geocode/json",BASE_URL:"/JoinSport/",MODE:"production",DEV:!1,PROD:!0},J={setup:()=>({v$:N()}),inject:["reload"],props:{activity:{type:Object}},data(){return{id:null,title:"",description:"",city:"",district:"",address:"",date:"",startTime:"",paymentMethod:"",costPerPerson:null,maxJoinNum:null,submitted:!1,tempDistrict:[]}},computed:{dateString(){const e=new Date(this.date),s=e.getFullYear(),c=e.getMonth()+1,u=e.getDate();return`${s}-${c.toString().padStart(2,"0")}-${u.toString().padStart(2,"0")}`},tempFormData(){return{title:this.title,description:this.description,city:this.city,district:this.district,address:this.address,date:this.dateString,startTime:this.startTime,paymentMethod:this.paymentMethod,costPerPerson:this.costPerPerson,maxJoinNum:this.maxJoinNum}},taiwanCities(){return this.tempDistrict.map(s=>({name:s.name}))},districts(){var s;return this.tempDistrict.reduce((c,u)=>{const t=u.name,h=u.districts.map(v=>({name:v.name}));return c[t]?c[t].push(...h):c[t]=h,c},{})[(s=this.city)==null?void 0:s.name]},...V(M,["joinNums","startTimes","paymentMethods"])},validations(){return{title:{required:p},description:{required:p},city:{required:p},district:{required:p},address:{required:p},date:{required:p},startTime:{required:p},paymentMethod:{required:p},costPerPerson:{required:p},maxJoinNum:{required:p}}},methods:{handleSubmit(e){this.submitted=!0,e&&localStorage.setItem("createTempFormData",JSON.stringify(this.tempFormData))},handleUpdate(e){if(this.submitted=!0,!e)return;const s={...this.tempFormData,city:this.city.name,district:this.district.name,paymentMethod:this.paymentMethod.method,maxJoinNum:this.maxJoinNum.number},{id:c}=this,u=`${D}/activities/${c}`;this.$http.patch(u,s).then(t=>{console.log(t.data),alert("修改成功"),this.reload()}).catch(t=>{console.log(t)}),console.log(123)},getFormData(){if(localStorage.getItem("createTempFormData")){const e=JSON.parse(localStorage.getItem("createTempFormData")),[s]=e.date.split("T");this.title=e.title,this.description=e.description,this.city=e.city,this.district=e.district,this.address=e.address,this.date=s,this.costPerPerson=e.costPerPerson,this.paymentMethod=e.paymentMethod,this.startTime=e.startTime,this.maxJoinNum=e.maxJoinNum}},resetForm(){this.title="",this.description="",this.city="",this.district="",this.address="",this.date=null,this.costPerPerson=null,this.paymentMethod="",this.startTime="",this.maxJoinNum=null,this.submitted=!1},getTaiwanDistrictData(){const e="https://gist.githubusercontent.com/abc873693/2804e64324eaaf26515281710e1792df/raw/a1e1fc17d04b47c564bbd9dba0d59a6a325ec7c1/taiwan_districts.json";this.$http.get(e).then(s=>{this.tempDistrict=s.data}).then(s=>{console.log(s)})},changeToZhTW(){this.$primevue.config.locale.emptyMessage="請先選擇縣市",this.$primevue.config.locale.monthNames=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],this.$primevue.config.locale.dayNamesMin=["日","一","二","三","四","五","六"]}},watch:{activity(e){this.id=e.id,this.title=e.title,this.description=e.description,this.city={name:e.city},this.district={name:e.district},this.address=e.address,this.date=e.date,this.costPerPerson=e.costPerPerson,this.paymentMethod={method:e.paymentMethod},this.startTime=e.startTime,this.maxJoinNum={number:e.maxJoinNum}}},mounted(){this.getFormData(),this.getTaiwanDistrictData(),this.changeToZhTW()}},y=e=>(T("data-v-9f56eb95"),e=e(),w(),e),S={class:"flex flex-col gap-6"},k={class:"flex items-center"},I={key:0,class:"p-error block text-end"},F={class:"flex items-center"},_={key:0,class:"p-error block text-end"},U={class:"flex gap-4"},E={class:"flex items-center"},q={key:0,class:"p-error block text-end"},L={key:0,class:"p-error block text-end"},j={class:"flex items-center"},A={key:0,class:"p-error block text-end"},B={class:"flex justify-between"},C={class:"flex items-center"},O={key:0,class:"p-error block text-end"},R={class:"flex items-center"},z={key:0,class:"p-error block text-end"},Y={class:"mt-6 flex items-center justify-between gap-6"},Z={class:"w-full"},G={class:"p-float-label"},K=y(()=>i("label",{for:"paymentMethod"},"付費方式",-1)),W={key:0,class:"p-error block text-end"},X={class:"w-full"},H={class:"p-float-label"},Q=y(()=>i("label",{for:"costPerPerson"},"每人費用",-1)),x={key:0,class:"p-error block text-end"},ee={class:"w-full"},te={class:"p-float-label"},se=y(()=>i("label",{for:"maxJoinNum"},"人數",-1)),ie={key:0,class:"p-error block text-end"};function oe(e,s,c,u,t,h){const v=b("InputText"),$=b("PDropdown"),f=b("PCalendar"),g=b("InputNumber");return a(),r("form",S,[i("div",null,[i("div",k,[i("label",{for:"title",class:l(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.title.$invalid&&t.submitted}])},"揪團標題",2),n(v,{id:"title",type:"text",modelValue:e.v$.title.$model,"onUpdate:modelValue":s[0]||(s[0]=o=>e.v$.title.$model=o),placeholder:"請輸入揪團標題",class:l(["w-full",{"p-invalid":e.v$.title.$invalid&&t.submitted}])},null,8,["modelValue","class"])]),e.v$.title.$invalid&&t.submitted||e.v$.title.$pending.$response?(a(),r("small",I,d(e.v$.title.required.$message.replace("Value","標題")),1)):m("",!0)]),i("div",null,[i("div",F,[i("label",{for:"description",class:l(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.description.$invalid&&t.submitted}])},"揪團描述",2),n(v,{id:"description",type:"text",modelValue:e.v$.description.$model,"onUpdate:modelValue":s[1]||(s[1]=o=>e.v$.description.$model=o),placeholder:"簡單描述此揪團",class:l(["w-full",{"p-invalid":e.v$.description.$invalid&&t.submitted}])},null,8,["modelValue","class"])]),e.v$.description.$invalid&&t.submitted||e.v$.description.$pending.$response?(a(),r("small",_,d(e.v$.description.required.$message.replace("Value","描述")),1)):m("",!0)]),i("div",U,[i("div",null,[i("div",E,[i("label",{for:"city",class:l(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.city.$invalid&&t.submitted}])},"活動地區",2),n($,{id:"city",modelValue:e.v$.city.$model,"onUpdate:modelValue":s[2]||(s[2]=o=>e.v$.city.$model=o),optionLabel:"name",placeholder:"請選擇活動縣市",options:h.taiwanCities,class:l(["w-full",{"p-invalid":e.v$.city.$invalid&&t.submitted}])},null,8,["modelValue","options","class"])]),e.v$.city.$invalid&&t.submitted||e.v$.city.$pending.$response?(a(),r("small",q,d(e.v$.city.required.$message.replace("Value","縣市")),1)):m("",!0)]),i("div",null,[n($,{id:"district",modelValue:e.v$.district.$model,"onUpdate:modelValue":s[3]||(s[3]=o=>e.v$.district.$model=o),optionLabel:"name",placeholder:"請選擇活動地區",options:h.districts,class:l(["w-full",{"p-invalid":e.v$.district.$invalid&&t.submitted}])},null,8,["modelValue","options","class"]),e.v$.district.$invalid&&t.submitted||e.v$.district.$pending.$response?(a(),r("small",L,d(e.v$.district.required.$message.replace("Value","地區")),1)):m("",!0)])]),i("div",null,[i("div",j,[i("label",{for:"address",class:l(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.address.$invalid&&t.submitted}])},"活動地址",2),n(v,{id:"address",type:"text",class:l(["w-full",{"p-invalid":e.v$.address.$invalid&&t.submitted}]),modelValue:e.v$.address.$model,"onUpdate:modelValue":s[4]||(s[4]=o=>e.v$.address.$model=o),placeholder:"請輸入活動地址"},null,8,["modelValue","class"])]),e.v$.address.$invalid&&t.submitted||e.v$.address.$pending.$response?(a(),r("small",A,d(e.v$.address.required.$message.replace("Value","地址")),1)):m("",!0)]),i("div",B,[i("div",null,[i("div",C,[i("label",{for:"date",class:l(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.date.$invalid&&t.submitted}])},"活動日期",2),n(f,{id:"date",modelValue:e.v$.date.$model,"onUpdate:modelValue":s[5]||(s[5]=o=>e.v$.date.$model=o),placeholder:"請選擇活動日期",dateFormat:"yy-mm-dd",showIcon:!0,class:l(["w-full",{"p-invalid":e.v$.date.$invalid&&t.submitted}])},null,8,["modelValue","class"])]),e.v$.date.$invalid&&t.submitted||e.v$.date.$pending.$response?(a(),r("small",O,d(e.v$.date.required.$message.replace("Value","日期")),1)):m("",!0)]),i("div",null,[i("div",R,[i("label",{for:"startTime",class:l(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.startTime.$invalid&&t.submitted}])},"開始時間",2),n($,{id:"startTime",modelValue:t.startTime,"onUpdate:modelValue":s[6]||(s[6]=o=>t.startTime=o),options:e.startTimes,optionLabel:"time",placeholder:"請選擇開始時間",class:l(["w-full",{"p-invalid":e.v$.startTime.$invalid&&t.submitted}])},null,8,["modelValue","options","class"])]),e.v$.startTime.$invalid&&t.submitted||e.v$.startTime.$pending.$response?(a(),r("small",z,d(e.v$.startTime.required.$message.replace("Value","時間")),1)):m("",!0)])]),i("div",Y,[i("div",Z,[i("div",G,[n($,{id:"paymentMethod",modelValue:t.paymentMethod,"onUpdate:modelValue":s[7]||(s[7]=o=>t.paymentMethod=o),options:e.paymentMethods,optionLabel:"method",class:l(["w-full",{"p-invalid":e.v$.paymentMethod.$invalid&&t.submitted}])},null,8,["modelValue","options","class"]),K]),e.v$.paymentMethod.$invalid&&t.submitted||e.v$.paymentMethod.$pending.$response?(a(),r("small",W,d(e.v$.paymentMethod.required.$message.replace("Value","付費方式")),1)):m("",!0)]),i("div",X,[i("div",H,[n(g,{id:"costPerPerson",modelValue:t.costPerPerson,"onUpdate:modelValue":s[8]||(s[8]=o=>t.costPerPerson=o),class:l(["w-full",{"p-invalid":e.v$.costPerPerson.$invalid&&t.submitted}])},null,8,["modelValue","class"]),Q]),e.v$.costPerPerson.$invalid&&t.submitted||e.v$.costPerPerson.$pending.$response?(a(),r("small",x,d(e.v$.costPerPerson.required.$message.replace("Value","費用")),1)):m("",!0)]),i("div",ee,[i("div",te,[n($,{id:"maxJoinNum",modelValue:t.maxJoinNum,"onUpdate:modelValue":s[9]||(s[9]=o=>t.maxJoinNum=o),class:l(["w-full",{"p-invalid":e.v$.maxJoinNum.$invalid&&t.submitted}]),options:e.joinNums,optionLabel:"number"},null,8,["modelValue","options","class"]),se]),e.v$.maxJoinNum.$invalid&&t.submitted||e.v$.maxJoinNum.$pending.$response?(a(),r("small",ie,d(e.v$.maxJoinNum.required.$message.replace("Value","人數")),1)):m("",!0)])])])}const ne=P(J,[["render",oe],["__scopeId","data-v-9f56eb95"]]);export{ne as V};
