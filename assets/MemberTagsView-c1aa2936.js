import{_ as k,s as b,t as m,a as r,d as f,b as t,e as g,C as u,z as D,v as T,F as h,B as y,x as p,u as E,r as _,o,G as L}from"./index-cbe3335a.js";import{s as x}from"./searchStore-f172184d.js";import{m as S}from"./memberStore-4bc7f034.js";const N={name:"MemberTagsView",data(){return{userId:null,isDisabled:!0,tempSelectedTag:"",selectedTags:[],filteredTags:null,filterList:[]}},computed:{...b(x,["tags","tagList"]),...b(S,["user"])},methods:{...m(E,["getUserId"]),...m(x,["getTags"]),...m(S,["getMemberData","editMemberData"]),searchTag(l){this.selectedTags.length<=4&&setTimeout(()=>{l.query.trim().length?this.filteredTags=this.filterList.filter(e=>e.label.toLowerCase().match(l.query.toLowerCase())):this.filteredTags=[...this.filterList]},250)},addTag(l){if(l.target.tagName==="BUTTON"){const d=l.target.textContent;this.selectedTags.push(d),this.tempSelectedTag="";return}if(l.target.tagName==="A"){const d=this.tempSelectedTag.value||this.tempSelectedTag;if(this.selectedTags.some(a=>a===d)){this.$toast.add({severity:"warn",detail:"已有相同標籤",life:1e3});return}if(d===""){this.$toast.add({severity:"info",detail:"請輸入標籤內容",life:1e3});return}this.selectedTags.push(d),this.tempSelectedTag="";return}const e=l.target.value;if(this.selectedTags.some(d=>d===e)){this.$toast.add({severity:"warn",detail:"已有相同標籤",life:1e3});return}if(e===""){this.$toast.add({severity:"info",detail:"請輸入標籤內容",life:1e3});return}this.selectedTags.push(e),this.tempSelectedTag=""},handleSubmit(){const l={id:this.userId,favoriteSports:this.selectedTags};this.editMemberData(l),this.$toast.add({severity:"success",detail:"修改成功",life:1e3}),this.isDisabled=!0},enableEdit(){this.isDisabled=!this.isDisabled},removeTag(l){this.selectedTags.splice(l,1)},cancelEdit(){this.getMemberData(this.user.id),this.enableEdit()}},watch:{tagList(){this.filterList=JSON.parse(JSON.stringify(this.tagList))},user(){this.selectedTags=JSON.parse(JSON.stringify(this.user.favoriteSports))}},mounted(){this.getTags(),this.userId=this.getUserId(),this.getMemberData(this.userId)}},V=t("h2",{class:"mb-8 text-xl"},"設定個人標籤",-1),M={class:"mb-10"},I={class:"mb-4 text-lg"},B={class:"text-primary-01"},O={class:"flex flex-col md:flex-row md:items-center"},A=t("i",{class:"pi pi-pencil ml-4 mr-1"},null,-1),J={class:"mb-10"},U={class:"flex flex-wrap items-center gap-3"},K={class:"mr-4 text-sm"},j=["onClick"],q=t("i",{class:"pi pi-times text-xs"},null,-1),z=[q],F={key:0,class:"mt-10 ml-auto flex gap-4"},P={key:0},G={class:"mb-10"},H=t("h3",{class:"mb-4 ml-2 text-lg"},"Tags :",-1),Q={class:"flex flex-wrap"},R=["disabled"];function W(l,e,w,d,i,a){const C=_("PToast"),v=_("AutoComplete");return o(),r(h,null,[f(C),t("main",null,[V,t("section",M,[t("h3",I,[g(" 可以新增 "),t("strong",B,u(5-i.selectedTags.length),1),g(" 個標籤 ")]),t("div",O,[f(v,{modelValue:i.tempSelectedTag,"onUpdate:modelValue":e[0]||(e[0]=s=>i.tempSelectedTag=s),suggestions:i.filteredTags,onComplete:a.searchTag,onKeyup:D(a.addTag,["enter"]),optionLabel:"label",loadingIcon:"false",placeholder:"輸入適合您的標籤 ( 例如: 攀岩 )",disabled:i.selectedTags.length===5||i.isDisabled===!0},null,8,["modelValue","suggestions","onComplete","onKeyup","disabled"]),i.isDisabled===!0?(o(),r("a",{key:0,href:"#",onClick:e[1]||(e[1]=T((...s)=>a.enableEdit&&a.enableEdit(...s),["prevent"])),class:"mt-2 hover:text-primary-01 md:mt-0"},[A,g(" 編輯標籤 ")])):(o(),r("a",{key:1,href:"#",onClick:e[2]||(e[2]=T((...s)=>a.addTag&&a.addTag(...s),["prevent"])),class:"btn btn-primary mt-2 ml-1 w-1/4 px-2 py-3 md:mt-0 md:w-auto"}," 新增 "))])]),t("section",J,[t("ul",U,[(o(!0),r(h,null,y(i.selectedTags,(s,n)=>(o(),r("li",{class:"flex items-center rounded-full bg-secondary-yellow py-2 pl-8 pr-4",key:s+n},[t("span",K,u(s),1),i.isDisabled?p("",!0):(o(),r("button",{key:0,type:"button",class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary-03",onClick:c=>a.removeTag(n)},z,8,j))]))),128))]),i.isDisabled?p("",!0):(o(),r("div",F,[t("button",{type:"button",onClick:e[3]||(e[3]=(...s)=>a.handleSubmit&&a.handleSubmit(...s)),class:"btn btn-primary px-3"}," 儲存變更 "),t("button",{type:"button",onClick:e[4]||(e[4]=(...s)=>a.cancelEdit&&a.cancelEdit(...s)),class:"btn btn-primary px-3"}," 取消 ")]))]),i.isDisabled?p("",!0):(o(),r("section",P,[t("div",G,[H,t("ul",Q,[(o(!0),r(h,null,y(l.tags,(s,n)=>(o(),r("li",{class:"flex items-center justify-center",key:s+n},[t("button",{class:L(["mb-2 mr-2 rounded-full bg-primary-02 px-8 py-2 hover:bg-primary-04",{hidden:i.selectedTags.some(c=>c===s),"cursor-not-allowed opacity-50":i.selectedTags.length===5}]),type:"button",disabled:i.selectedTags.length===5,onClick:e[5]||(e[5]=(...c)=>a.addTag&&a.addTag(...c))},u(s),11,R)]))),128))])])]))])],64)}const $=k(N,[["render",W]]);export{$ as default};
