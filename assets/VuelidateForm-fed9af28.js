import{s as V,_ as T,r as y,o as r,a as n,b as i,G as a,d,B as m,E as p,C as w,D as P}from"./index-a1b525d1.js";import{u as D,r as u}from"./i18n-validators-611a8dc4.js";import{c as M}from"./createStepsStore-06040fd5.js";const{VITE_URL:N}={VITE_URL:"https://join-sport-server-vercel.vercel.app",VITE_PATH:"key0329",VITE_TEXT:"這是產品的環境",VITE_MAP_KEY:"AIzaSyAScKOJBsEFvLrg4YGx5ticXsBzFYZPATw",VITE_MAP_URL:"https://maps.googleapis.com/maps/api/geocode/json",BASE_URL:"/JoinSport/",MODE:"production",DEV:!1,PROD:!0},S={name:"VuelidateForm",setup:()=>({v$:D()}),props:{activity:{type:Object}},data(){return{id:null,title:"",description:"",city:"",district:"",address:"",date:"",startTime:"",paymentMethod:"",costPerPerson:null,maxJoinNum:null,submitted:!1,tempDistrict:[]}},computed:{dateString(){const e=new Date(this.date),s=e.getFullYear(),l=e.getMonth()+1,c=e.getDate();return`${s}-${l.toString().padStart(2,"0")}-${c.toString().padStart(2,"0")}`},tempFormData(){return{title:this.title,description:this.description,city:this.city,district:this.district,address:this.address,date:this.dateString,startTime:this.startTime,paymentMethod:this.paymentMethod,costPerPerson:this.costPerPerson,maxJoinNum:this.maxJoinNum}},taiwanCities(){return this.tempDistrict.map(s=>({name:s.name}))},districts(){var s;return this.tempDistrict.reduce((l,c)=>{const t=c.name,v=c.districts.map(h=>({name:h.name}));return l[t]?l[t].push(...v):l[t]=v,l},{})[(s=this.city)==null?void 0:s.name]},...V(M,["joinNums","startTimes","paymentMethods"])},validations(){return{title:{required:u},description:{required:u},city:{required:u},district:{required:u},address:{required:u},date:{required:u},startTime:{required:u},paymentMethod:{required:u},costPerPerson:{required:u},maxJoinNum:{required:u}}},methods:{handleSubmit(e){this.submitted=!0,e&&localStorage.setItem("createTempFormData",JSON.stringify(this.tempFormData))},handleUpdate(e){if(this.submitted=!0,!e)return;const s={...this.tempFormData,city:this.city.name,district:this.district.name,paymentMethod:this.paymentMethod.method,maxJoinNum:this.maxJoinNum.number},{id:l}=this,c=`${N}/activities/${l}`;this.$http.patch(c,s).then(()=>{this.$toast.add({severity:"success",detail:"更新成功",life:1e3}),this.getFormData()}).catch(t=>{const v=t.response.statusText;this.$toast.add({severity:"error",detail:`${v} 更新失敗`,life:1e3,contentStyleClass:"custom-toast-danger"})})},getFormData(){if(localStorage.getItem("createTempFormData")){const e=JSON.parse(localStorage.getItem("createTempFormData")),[s]=e.date.split("T");this.title=e.title,this.description=e.description,this.city=e.city,this.district=e.district,this.address=e.address,this.date=s,this.costPerPerson=e.costPerPerson,this.paymentMethod=e.paymentMethod,this.startTime=e.startTime,this.maxJoinNum=e.maxJoinNum}},getTaiwanDistrictData(){const e="https://gist.githubusercontent.com/abc873693/2804e64324eaaf26515281710e1792df/raw/a1e1fc17d04b47c564bbd9dba0d59a6a325ec7c1/taiwan_districts.json";this.$http.get(e).then(s=>{this.tempDistrict=s.data}).then(s=>{const l=s;this.$toast.add({severity:"error",detail:`${l}`,life:1e3,contentStyleClass:"custom-toast-danger"})})},changeToZhTW(){this.$primevue.config.locale.emptyMessage="請先選擇縣市",this.$primevue.config.locale.monthNames=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],this.$primevue.config.locale.dayNamesMin=["日","一","二","三","四","五","六"]}},watch:{activity(e){this.id=e.id,this.title=e.title,this.description=e.description,this.city={name:e.city},this.district={name:e.district},this.address=e.address,this.date=e.date,this.costPerPerson=e.costPerPerson,this.paymentMethod={method:e.paymentMethod},this.startTime=e.startTime,this.maxJoinNum={number:e.maxJoinNum}}},mounted(){this.getFormData(),this.getTaiwanDistrictData(),this.changeToZhTW()}},b=e=>(w("data-v-8048e9b7"),e=e(),P(),e),k={class:"flex flex-col gap-6"},J={class:"flex items-center"},F={key:0,class:"p-error block text-end"},I={class:"flex items-center"},_={key:0,class:"p-error block text-end"},U={class:"flex gap-4"},E={class:"flex items-center"},C={key:0,class:"p-error block text-end"},q={key:0,class:"p-error block text-end"},L={class:"flex items-center"},j={key:0,class:"p-error block text-end"},A={class:"flex justify-between"},B={class:"flex items-center"},O={key:0,class:"p-error block text-end"},R={class:"flex items-center"},Y={key:0,class:"p-error block text-end"},z={class:"mt-6 flex items-center justify-between gap-6"},Z={class:"w-full"},G={class:"p-float-label"},K=b(()=>i("label",{for:"paymentMethod"},"付費方式",-1)),W={key:0,class:"p-error block text-end"},X={class:"w-full"},H={class:"p-float-label"},Q=b(()=>i("label",{for:"costPerPerson"},"每人費用",-1)),x={key:0,class:"p-error block text-end"},ee={class:"w-full"},te={class:"p-float-label"},se=b(()=>i("label",{for:"maxJoinNum"},"人數",-1)),ie={key:0,class:"p-error block text-end"};function oe(e,s,l,c,t,v){const h=y("InputText"),$=y("PDropdown"),f=y("PCalendar"),g=y("InputNumber");return r(),n("form",k,[i("div",null,[i("div",J,[i("label",{for:"title",class:a(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.title.$invalid&&t.submitted}])},"揪團標題",2),d(h,{id:"title",type:"text",modelValue:e.v$.title.$model,"onUpdate:modelValue":s[0]||(s[0]=o=>e.v$.title.$model=o),placeholder:"請輸入揪團標題",class:a(["w-full",{"p-invalid":e.v$.title.$invalid&&t.submitted}])},null,8,["modelValue","class"])]),e.v$.title.$invalid&&t.submitted||e.v$.title.$pending.$response?(r(),n("small",F,m(e.v$.title.required.$message.replace("Value","標題")),1)):p("",!0)]),i("div",null,[i("div",I,[i("label",{for:"description",class:a(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.description.$invalid&&t.submitted}])},"揪團描述",2),d(h,{id:"description",type:"text",modelValue:e.v$.description.$model,"onUpdate:modelValue":s[1]||(s[1]=o=>e.v$.description.$model=o),placeholder:"簡單描述此揪團",class:a(["w-full",{"p-invalid":e.v$.description.$invalid&&t.submitted}])},null,8,["modelValue","class"])]),e.v$.description.$invalid&&t.submitted||e.v$.description.$pending.$response?(r(),n("small",_,m(e.v$.description.required.$message.replace("Value","描述")),1)):p("",!0)]),i("div",U,[i("div",null,[i("div",E,[i("label",{for:"formCity",class:a(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.city.$invalid&&t.submitted}])},"活動地區",2),d($,{id:"formCity",modelValue:e.v$.city.$model,"onUpdate:modelValue":s[2]||(s[2]=o=>e.v$.city.$model=o),optionLabel:"name",placeholder:"請選擇活動縣市",options:v.taiwanCities,class:a(["w-full",{"p-invalid":e.v$.city.$invalid&&t.submitted}])},null,8,["modelValue","options","class"])]),e.v$.city.$invalid&&t.submitted||e.v$.city.$pending.$response?(r(),n("small",C,m(e.v$.city.required.$message.replace("Value","縣市")),1)):p("",!0)]),i("div",null,[d($,{id:"district",modelValue:e.v$.district.$model,"onUpdate:modelValue":s[3]||(s[3]=o=>e.v$.district.$model=o),optionLabel:"name",placeholder:"請選擇活動地區",options:v.districts,class:a(["w-full",{"p-invalid":e.v$.district.$invalid&&t.submitted}])},null,8,["modelValue","options","class"]),e.v$.district.$invalid&&t.submitted||e.v$.district.$pending.$response?(r(),n("small",q,m(e.v$.district.required.$message.replace("Value","地區")),1)):p("",!0)])]),i("div",null,[i("div",L,[i("label",{for:"address",class:a(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.address.$invalid&&t.submitted}])},"活動地址",2),d(h,{id:"address",type:"text",class:a(["w-full",{"p-invalid":e.v$.address.$invalid&&t.submitted}]),modelValue:e.v$.address.$model,"onUpdate:modelValue":s[4]||(s[4]=o=>e.v$.address.$model=o),placeholder:"請輸入活動地址"},null,8,["modelValue","class"])]),e.v$.address.$invalid&&t.submitted||e.v$.address.$pending.$response?(r(),n("small",j,m(e.v$.address.required.$message.replace("Value","地址")),1)):p("",!0)]),i("div",A,[i("div",null,[i("div",B,[i("label",{for:"formDate",class:a(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.date.$invalid&&t.submitted}])},"活動日期",2),d(f,{id:"formDate",modelValue:e.v$.date.$model,"onUpdate:modelValue":s[5]||(s[5]=o=>e.v$.date.$model=o),placeholder:"請選擇活動日期",dateFormat:"yy-mm-dd",showIcon:!0,minDate:new Date,class:a(["w-full",{"p-invalid":e.v$.date.$invalid&&t.submitted}])},null,8,["modelValue","minDate","class"])]),e.v$.date.$invalid&&t.submitted||e.v$.date.$pending.$response?(r(),n("small",O,m(e.v$.date.required.$message.replace("Value","日期")),1)):p("",!0)]),i("div",null,[i("div",R,[i("label",{for:"startTime",class:a(["mr-4 whitespace-nowrap px-2",{"p-error":e.v$.startTime.$invalid&&t.submitted}])},"開始時間",2),d($,{id:"startTime",modelValue:t.startTime,"onUpdate:modelValue":s[6]||(s[6]=o=>t.startTime=o),options:e.startTimes,optionLabel:"time",placeholder:"請選擇開始時間",class:a(["w-full",{"p-invalid":e.v$.startTime.$invalid&&t.submitted}])},null,8,["modelValue","options","class"])]),e.v$.startTime.$invalid&&t.submitted||e.v$.startTime.$pending.$response?(r(),n("small",Y,m(e.v$.startTime.required.$message.replace("Value","時間")),1)):p("",!0)])]),i("div",z,[i("div",Z,[i("div",G,[d($,{id:"paymentMethod",modelValue:t.paymentMethod,"onUpdate:modelValue":s[7]||(s[7]=o=>t.paymentMethod=o),options:e.paymentMethods,optionLabel:"method",class:a(["w-full",{"p-invalid":e.v$.paymentMethod.$invalid&&t.submitted}])},null,8,["modelValue","options","class"]),K]),e.v$.paymentMethod.$invalid&&t.submitted||e.v$.paymentMethod.$pending.$response?(r(),n("small",W,m(e.v$.paymentMethod.required.$message.replace("Value","付費方式")),1)):p("",!0)]),i("div",X,[i("div",H,[d(g,{id:"costPerPerson",modelValue:t.costPerPerson,"onUpdate:modelValue":s[8]||(s[8]=o=>t.costPerPerson=o),class:a(["w-full",{"p-invalid":e.v$.costPerPerson.$invalid&&t.submitted}])},null,8,["modelValue","class"]),Q]),e.v$.costPerPerson.$invalid&&t.submitted||e.v$.costPerPerson.$pending.$response?(r(),n("small",x,m(e.v$.costPerPerson.required.$message.replace("Value","費用")),1)):p("",!0)]),i("div",ee,[i("div",te,[d($,{id:"maxJoinNum",modelValue:t.maxJoinNum,"onUpdate:modelValue":s[9]||(s[9]=o=>t.maxJoinNum=o),class:a(["w-full",{"p-invalid":e.v$.maxJoinNum.$invalid&&t.submitted}]),options:e.joinNums,optionLabel:"number"},null,8,["modelValue","options","class"]),se]),e.v$.maxJoinNum.$invalid&&t.submitted||e.v$.maxJoinNum.$pending.$response?(r(),n("small",ie,m(e.v$.maxJoinNum.required.$message.replace("Value","人數")),1)):p("",!0)])])])}const ne=T(S,[["render",oe],["__scopeId","data-v-8048e9b7"]]);export{ne as V};
