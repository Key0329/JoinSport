import{J as A}from"./JoinCardRow-3e788fc8.js";import{L}from"./LeafletMap-aa7f2692.js";import{_ as P,s as D,t as _,a as m,b as g,B as p,H as T,E as k,F as w,A as S,d,u as C,r as u,o as h,w as I}from"./index-29bbafb4.js";import{j as f}from"./activitiesStore-3a3e71f1.js";import{P as b}from"./PaginationComponent-092fae5d.js";import"./leaflet-src-552bf412.js";const J={name:"JoinListSearchView",components:{JoinCardRow:A,LeafletMap:L,PaginationComponent:b},data(){return{userId:null,currentPage:1,searchText:"",searchArea:"",searchDate:""}},computed:{...D(f,["availableActivities","isLoading"]),searchActivitiesList(){const o=this.availableActivities.filter(e=>e.isCancelled===!1),s=this.searchText,a=this.searchArea,r=this.searchDate,c=o.filter(e=>{const n=new Date(e.originDate).toISOString().split("T")[0];return s!=="0"&&a!=="0"&&r!=="0"?e.tags.some(i=>i.includes(s))&&e.city===a&&n===r:s!=="0"&&a!=="0"?e.tags.some(i=>i.includes(s))&&e.city===a:s!=="0"&&r!=="0"?e.tags.some(i=>i.includes(s))&&n===r:a!=="0"&&r!=="0"?e.city===a&&n===r:s!=="0"||a!=="0"||r!=="0"?e.tags.some(i=>i.includes(s))||e.city===a||n===r:e}).sort((e,n)=>n.numParticipants-e.numParticipants);return this.arrangePage(c)}},methods:{..._(f,["getOrders","getActivities","changePage","arrangePage"]),..._(C,["getUserId"]),getParams(){const{text:o,area:s,date:a}=this.$route.params;this.searchText=o,this.searchArea=s,this.searchDate=a}},watch:{$route(o){this.currentPage=o.params.page,this.changePage(o.params.page),this.getParams()}},mounted(){this.getActivities(),this.getOrders(),this.changePage(this.$route.params.page),this.userId=this.getUserId(),this.getParams()}},B={class:"pt-4 pb-20 md:pt-10"},V={class:"container"},j={class:"mb-6 text-center text-2xl md:mb-10 md:text-start"},M={class:"grid gap-8 md:grid-cols-12 lg:gap-0"},N={key:0,class:"col-span-7 text-xl"},O={key:1,class:"col-span-7 flex flex-col gap-6"},R={class:"sticky top-[286px] col-span-4 col-end-13 hidden h-[400px] md:flex"};function U(o,s,a,r,t,c){const e=u("PaginationComponent"),n=u("join-card-row"),i=u("RouterLink"),x=u("LeafletMap");return h(),m("main",B,[g("div",V,[g("h2",j," 搜尋揪團： "+p(t.searchText==="0"?"":t.searchText)+" "+p(t.searchText==="0"||t.searchArea==="0"&&t.searchDate==="0"?"":" +")+" "+p(t.searchArea==="0"?"":t.searchArea)+" "+p(t.searchArea==="0"||t.searchDate==="0"?"":" +")+" "+p(t.searchDate==="0"?"":t.searchDate),1),c.searchActivitiesList.pageTotal?(h(),T(e,{key:0,currentPage:t.currentPage,pageTotal:c.searchActivitiesList.pageTotal,pageUrl:"/JoinList/Search/${}",class:"mb-4"},null,8,["currentPage","pageTotal"])):k("",!0),g("section",M,[c.searchActivitiesList.pageTotal===0?(h(),m("h3",N," 無搜尋結果 ")):(h(),m("ul",O,[(h(!0),m(w,null,S(c.searchActivitiesList.list,l=>(h(),m("li",{key:l==null?void 0:l.id},[d(i,{to:`/JoinDetail/id=${l==null?void 0:l.id}`},{default:I(()=>[d(n,{activity:l,userId:t.userId},null,8,["activity","userId"])]),_:2},1032,["to"])]))),128))])),g("aside",R,[d(x,{mapActivities:c.searchActivitiesList.list},null,8,["mapActivities"])])])])])}const G=P(J,[["render",U]]);export{G as default};
