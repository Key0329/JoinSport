import{H as D,I as k,_ as C,G as h,s as u,a,b as s,e as m,B as g,d as L,U as v,u as T,F as b,C as f,D as p,t as w,r as E,o,J as V}from"./index-1031d0a2.js";import{m as _}from"./memberStore-6c825350.js";const{VITE_URL:I}={VITE_URL:"https://vercel.com/key0329/join-sport-server-vercel",VITE_PATH:"key0329",VITE_TEXT:"這是產品的環境",BASE_URL:"/JoinSport/",MODE:"production",DEV:!1,PROD:!0},y=D("sportsStore",{state:()=>({sports:[]}),getters:{sportList(){return this.sports.map(e=>({label:e,value:e}))}},actions:{getSportsData(){const t=`${I}/sports`;k.get(t).then(e=>{this.sports=e.data}).catch(e=>{console.log(e)})}}}),N={inject:["reload"],data(){return{userId:null,isDisabled:!0,tempSelectedTag:"",selectedTags:[],filteredTags:null,filterList:[]}},computed:{...h(y,["sports","sportList"]),...h(_,["user"])},methods:{...u(w,["getUserId"]),...u(y,["getSportsData"]),...u(_,["getMemberData","editMemberData"]),searchTag(t){this.selectedTags.length<=4&&setTimeout(()=>{t.query.trim().length?this.filteredTags=this.filterList.filter(e=>e.label.toLowerCase().match(t.query.toLowerCase())):this.filteredTags=[...this.filterList]},250)},addTag(t){if(t.target.tagName==="BUTTON"){const n=t.target.textContent;this.selectedTags.push(n),this.tempSelectedTag="";return}if(t.target.tagName==="A"){const n=this.tempSelectedTag.value||this.tempSelectedTag;if(n===""){alert("請輸入標籤內容");return}this.selectedTags.push(n),this.tempSelectedTag="";return}const e=t.target.value;if(this.selectedTags.some(n=>n===e)){alert("已有相同標籤");return}if(e===""){alert("請輸入標籤內容");return}this.selectedTags.push(e),this.tempSelectedTag=""},handleSubmit(){const t={id:this.userId,favoriteSports:this.selectedTags};console.log(t),this.editMemberData(t),this.reload(),this.isDisabled=!0},enableEdit(){this.isDisabled=!this.isDisabled},removeTag(t){this.selectedTags.splice(t,1)}},watch:{sportList(){this.filterList=JSON.parse(JSON.stringify(this.sportList))},user(){this.selectedTags=JSON.parse(JSON.stringify(this.user.favoriteSports))}},mounted(){this.getSportsData(),this.userId=this.getUserId(),this.getMemberData(this.userId)}},U=s("h2",{class:"mb-8 text-xl"},"設定個人標籤",-1),M={class:"mb-10"},O={class:"mb-4 text-lg"},A={class:"text-primary-01"},B={class:"flex items-center"},J=s("i",{class:"pi pi-pencil ml-4 mr-1"},null,-1),j={class:"mb-10"},R={class:"flex flex-wrap items-center gap-3"},K={class:"mr-4 text-sm"},q=["onClick"],F=s("i",{class:"pi pi-times text-xs"},null,-1),H=[F],P={key:0},z={key:0},G={class:"mb-10"},X=s("h3",{class:"mb-4 ml-2 text-lg"},"Tags :",-1),Q={class:"flex flex-wrap"},W=["disabled"];function Y(t,e,S,n,r,i){const x=E("AutoComplete");return o(),a("main",null,[U,s("section",M,[s("h3",O,[m(" 可以新增 "),s("strong",A,g(5-r.selectedTags.length),1),m(" 個標籤 ")]),s("div",B,[L(x,{modelValue:r.tempSelectedTag,"onUpdate:modelValue":e[0]||(e[0]=l=>r.tempSelectedTag=l),suggestions:r.filteredTags,onComplete:i.searchTag,onKeyup:v(i.addTag,["enter"]),optionLabel:"label",loadingIcon:"false",placeholder:"輸入適合您的標籤 ( 例如: 攀岩 )",disabled:r.selectedTags.length===5||r.isDisabled===!0},null,8,["modelValue","suggestions","onComplete","onKeyup","disabled"]),r.isDisabled===!0?(o(),a("a",{key:0,href:"#",onClick:e[1]||(e[1]=T((...l)=>i.enableEdit&&i.enableEdit(...l),["prevent"])),class:"hover:text-primary-01"},[J,m(" 編輯標籤 ")])):(o(),a("a",{key:1,href:"#",onClick:e[2]||(e[2]=T((...l)=>i.addTag&&i.addTag(...l),["prevent"])),class:"btn btn-primary ml-1 px-2 py-3"}," 新增 "))])]),s("section",j,[s("ul",R,[(o(!0),a(b,null,f(r.selectedTags,(l,d)=>(o(),a("li",{class:"flex items-center rounded-full bg-secondary-yellow py-2 pl-8 pr-4",key:l+d},[s("span",K,g(l),1),r.isDisabled?p("",!0):(o(),a("button",{key:0,type:"button",class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary-03",onClick:c=>i.removeTag(d)},H,8,q))]))),128)),r.isDisabled?p("",!0):(o(),a("li",P,[s("button",{type:"button",onClick:e[3]||(e[3]=(...l)=>i.handleSubmit&&i.handleSubmit(...l)),class:"btn btn-primary px-3"}," 儲存變更 ")]))])]),r.isDisabled?p("",!0):(o(),a("section",z,[s("div",G,[X,s("ul",Q,[(o(!0),a(b,null,f(t.sports,(l,d)=>(o(),a("li",{class:"flex items-center justify-center",key:l+d},[s("button",{class:V(["mb-2 mr-2 rounded-full bg-primary-02 px-8 py-2 hover:bg-primary-04",{hidden:r.selectedTags.some(c=>c===l),"cursor-not-allowed opacity-50":r.selectedTags.length===5}]),type:"button",disabled:r.selectedTags.length===5,onClick:e[4]||(e[4]=(...c)=>i.addTag&&i.addTag(...c))},g(l),11,W)]))),128))])])]))])}const ee=C(N,[["render",Y]]);export{ee as default};
