import{J as A}from"./JoinCardRow-4cf17c52.js";import{L}from"./LeafletMap-161c7774.js";import{_ as P,x as D,s as _,a as g,b as p,D as m,I as T,E as k,F as w,H as I,d,t as S,r as u,o as h,w as C}from"./index-0203b16c.js";import{j as f}from"./joinActivitiesStore-55d9fd30.js";import{P as b}from"./PaginationComponent-5da94a74.js";import"./leaflet-src-c7cb1161.js";const J={name:"JoinListSearchView",components:{JoinCardRow:A,LeafletMap:L,PaginationComponent:b},data(){return{userId:null,currentPage:1,searchText:"",searchArea:"",searchDate:""}},computed:{...D(f,["availableActivities","isLoading"]),searchActivitiesList(){const i=this.availableActivities.filter(s=>s.isCancelled===!1),t=this.searchText,a=this.searchArea,r=this.searchDate,e=i.filter(s=>{const c=new Date(s.originDate).toISOString().split("T")[0];return t!=="0"&&a!=="0"&&r!=="0"?(console.log(1),s.tags.some(o=>o.includes(t))&&s.city===a&&c===r):t!=="0"&&a!=="0"?(console.log(2),s.tags.some(o=>o.includes(t))&&s.city===a):t!=="0"&&r!=="0"?(console.log(3),s.tags.some(o=>o.includes(t))&&c===r):a!=="0"&&r!=="0"?(console.log(4),s.city===a&&c===r):t!=="0"||a!=="0"||r!=="0"?s.tags.some(o=>o.includes(t))||s.city===a||c===r:s});console.log(e);const n=e.sort((s,c)=>c.numParticipants-s.numParticipants);return console.log(this.arrangePage(n)),this.arrangePage(n)}},methods:{..._(f,["getOrders","getActivities","changePage","arrangePage"]),..._(S,["getUserId"]),getParams(){const{text:i,area:t,date:a}=this.$route.params;this.searchText=i,this.searchArea=t,this.searchDate=a}},watch:{$route(i){this.currentPage=i.params.page,this.changePage(i.params.page)}},mounted(){this.getActivities(),this.getOrders(),this.changePage(this.$route.params.page),this.userId=this.getUserId(),this.getParams(),console.log(this.searchText,this.searchArea,this.searchDate)}},V={class:"pt-4 pb-20 md:pt-10"},j={class:"container"},B={class:"mb-6 text-center text-2xl md:mb-10 md:text-start"},M={class:"grid gap-8 md:grid-cols-12 lg:gap-0"},N={key:0,class:"col-span-7 text-xl"},O={key:1,class:"col-span-7 flex flex-col gap-6"},R={class:"sticky top-[286px] col-span-4 col-end-13 hidden h-[400px] md:flex"};function U(i,t,a,r,e,n){const s=u("PaginationComponent"),c=u("join-card-row"),o=u("RouterLink"),x=u("LeafletMap");return h(),g("main",V,[p("div",j,[p("h2",B," 搜尋揪團： "+m(e.searchText==="0"?"":e.searchText)+" "+m(e.searchText==="0"||e.searchArea==="0"&&e.searchDate==="0"?"":" +")+" "+m(e.searchArea==="0"?"":e.searchArea)+" "+m(e.searchArea==="0"||e.searchDate==="0"?"":" +")+" "+m(e.searchDate==="0"?"":e.searchDate),1),n.searchActivitiesList.pageTotal?(h(),T(s,{key:0,currentPage:e.currentPage,pageTotal:n.searchActivitiesList.pageTotal,pageUrl:"/JoinList/Search/${}",class:"mb-4"},null,8,["currentPage","pageTotal"])):k("",!0),p("section",M,[n.searchActivitiesList.pageTotal===0?(h(),g("h3",N," 無搜尋結果 ")):(h(),g("ul",O,[(h(!0),g(w,null,I(n.searchActivitiesList.list,l=>(h(),g("li",{key:l==null?void 0:l.id},[d(o,{to:`/JoinDetail/id=${l==null?void 0:l.id}`},{default:C(()=>[d(c,{activity:l,userId:e.userId},null,8,["activity","userId"])]),_:2},1032,["to"])]))),128))])),p("aside",R,[d(x,{mapActivities:n.searchActivitiesList.list},null,8,["mapActivities"])])])])])}const G=P(J,[["render",U]]);export{G as default};
