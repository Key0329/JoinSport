import{_ as C,G as p,s as g,a as r,b as s,e as m,B as u,d as k,U as D,u as b,F as T,C as f,D as h,t as w,r as v,o as n,J as E}from"./index-7c2a729a.js";import{t as y}from"./tagsStore-fc45949b.js";import{m as _}from"./memberStore-4b046559.js";const L={inject:["reload"],data(){return{userId:null,isDisabled:!0,tempSelectedTag:"",selectedTags:[],filteredTags:null,filterList:[]}},computed:{...p(y,["tags","tagList"]),...p(_,["user"])},methods:{...g(w,["getUserId"]),...g(y,["getTags"]),...g(_,["getMemberData","editMemberData"]),searchTag(i){this.selectedTags.length<=4&&setTimeout(()=>{i.query.trim().length?this.filteredTags=this.filterList.filter(e=>e.label.toLowerCase().match(i.query.toLowerCase())):this.filteredTags=[...this.filterList]},250)},addTag(i){if(i.target.tagName==="BUTTON"){const o=i.target.textContent;this.selectedTags.push(o),this.tempSelectedTag="";return}if(i.target.tagName==="A"){const o=this.tempSelectedTag.value||this.tempSelectedTag;if(this.selectedTags.some(a=>a===o)){alert("已有相同標籤");return}if(o===""){alert("請輸入標籤內容");return}this.selectedTags.push(o),this.tempSelectedTag="";return}const e=i.target.value;if(this.selectedTags.some(o=>o===e)){alert("已有相同標籤");return}if(e===""){alert("請輸入標籤內容");return}this.selectedTags.push(e),this.tempSelectedTag=""},handleSubmit(){const i={id:this.userId,favoriteSports:this.selectedTags};this.editMemberData(i),this.reload(),this.isDisabled=!0},enableEdit(){this.isDisabled=!this.isDisabled},removeTag(i){this.selectedTags.splice(i,1)},cancelEdit(){this.reload()}},watch:{tagList(){this.filterList=JSON.parse(JSON.stringify(this.tagList))},user(){this.selectedTags=JSON.parse(JSON.stringify(this.user.favoriteSports))}},mounted(){this.getTags(),this.userId=this.getUserId(),this.getMemberData(this.userId)}},N=s("h2",{class:"mb-8 text-xl"},"設定個人標籤",-1),V={class:"mb-10"},I={class:"mb-4 text-lg"},M={class:"text-primary-01"},B={class:"flex items-center"},J=s("i",{class:"pi pi-pencil ml-4 mr-1"},null,-1),O={class:"mb-10"},U={class:"flex flex-wrap items-center gap-3"},A={class:"mr-4 text-sm"},j=["onClick"],K=s("i",{class:"pi pi-times text-xs"},null,-1),q=[K],F={key:0,class:"mt-10 ml-auto flex gap-4"},z={key:0},G={class:"mb-10"},H=s("h3",{class:"mb-4 ml-2 text-lg"},"Tags :",-1),P={class:"flex flex-wrap"},Q=["disabled"];function R(i,e,x,o,l,a){const S=v("AutoComplete");return n(),r("main",null,[N,s("section",V,[s("h3",I,[m(" 可以新增 "),s("strong",M,u(5-l.selectedTags.length),1),m(" 個標籤 ")]),s("div",B,[k(S,{modelValue:l.tempSelectedTag,"onUpdate:modelValue":e[0]||(e[0]=t=>l.tempSelectedTag=t),suggestions:l.filteredTags,onComplete:a.searchTag,onKeyup:D(a.addTag,["enter"]),optionLabel:"label",loadingIcon:"false",placeholder:"輸入適合您的標籤 ( 例如: 攀岩 )",disabled:l.selectedTags.length===5||l.isDisabled===!0},null,8,["modelValue","suggestions","onComplete","onKeyup","disabled"]),l.isDisabled===!0?(n(),r("a",{key:0,href:"#",onClick:e[1]||(e[1]=b((...t)=>a.enableEdit&&a.enableEdit(...t),["prevent"])),class:"hover:text-primary-01"},[J,m(" 編輯標籤 ")])):(n(),r("a",{key:1,href:"#",onClick:e[2]||(e[2]=b((...t)=>a.addTag&&a.addTag(...t),["prevent"])),class:"btn btn-primary ml-1 px-2 py-3"}," 新增 "))])]),s("section",O,[s("ul",U,[(n(!0),r(T,null,f(l.selectedTags,(t,d)=>(n(),r("li",{class:"flex items-center rounded-full bg-secondary-yellow py-2 pl-8 pr-4",key:t+d},[s("span",A,u(t),1),l.isDisabled?h("",!0):(n(),r("button",{key:0,type:"button",class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary-03",onClick:c=>a.removeTag(d)},q,8,j))]))),128))]),l.isDisabled?h("",!0):(n(),r("div",F,[s("button",{type:"button",onClick:e[3]||(e[3]=(...t)=>a.handleSubmit&&a.handleSubmit(...t)),class:"btn btn-primary px-3"}," 儲存變更 "),s("button",{type:"button",onClick:e[4]||(e[4]=(...t)=>a.cancelEdit&&a.cancelEdit(...t)),class:"btn btn-primary px-3"}," 取消 ")]))]),l.isDisabled?h("",!0):(n(),r("section",z,[s("div",G,[H,s("ul",P,[(n(!0),r(T,null,f(i.tags,(t,d)=>(n(),r("li",{class:"flex items-center justify-center",key:t+d},[s("button",{class:E(["mb-2 mr-2 rounded-full bg-primary-02 px-8 py-2 hover:bg-primary-04",{hidden:l.selectedTags.some(c=>c===t),"cursor-not-allowed opacity-50":l.selectedTags.length===5}]),type:"button",disabled:l.selectedTags.length===5,onClick:e[5]||(e[5]=(...c)=>a.addTag&&a.addTag(...c))},u(t),11,Q)]))),128))])])]))])}const Z=C(L,[["render",R]]);export{Z as default};
