import{_ as N,G as W,s as j,a as d,d as l,b as t,B as r,e as b,w as u,F as _,C as f,t as F,r as m,o as h,z as H,A as M}from"./index-1031d0a2.js";import{j as C}from"./joinActivitiesStore-e4b70ed2.js";import{F as q}from"./FrontHeader-72a61db5.js";import{J as Z,a as G}from"./JoinDetailAside-b977ae8c.js";import{J as X}from"./JoinCardRow-f834328c.js";import"./avatar01-e06217d0.js";import"./LeafletMap-8281a880.js";import"./leaflet-src-df42830d.js";import"./group03-b38e3255.js";const{VITE_URL:y}={VITE_URL:"https://vercel.com/key0329/join-sport-server-vercel",VITE_PATH:"key0329",VITE_TEXT:"這是產品的環境",BASE_URL:"/JoinSport/",MODE:"production",DEV:!1,PROD:!0},K={inject:["reload"],components:{FrontHeader:q,JoinAttendees:Z,JoinCardRow:X,JoinDetailAside:G},data(){return{userId:null,activity:[],orders:[],textareaValue:""}},computed:{...W(C,["restructureActivitiesList"]),newDateActivity(){if(!this.activity.date)return{};const s=this.activity.date.split("-"),a=`${s[1]}/${s[2]}`,c=new Date(this.activity.date).getDay(),p=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][c];return{...this.activity,date:a,dayOfWeekText:p}},slicedActivities(){return[...this.restructureActivitiesList].filter(o=>o!=null&&o.id?o.id!==parseInt(this.$route.params.id,10):[]).sort(()=>Math.random()-.5).slice(0,2)},hadJoined(){return this.orders.find(s=>s.userId===parseInt(this.userId,10))!==void 0},isHost(){return this.activity.userId===this.userId}},methods:{...j(C,["getActivities","getOrders"]),...j(F,["getUserId"]),getActivityDetail(s){const a=`${y}/activities/${s}?_expand=user&_expand=group`;this.$http.get(a).then(c=>{this.activity=c.data}).catch(c=>{console.log(c),alert("err")})},getActivityOrders(s){const a=`${y}/orders?isCancelled=false&activityId=${s}&_expand=user`;this.$http.get(a).then(c=>{this.orders=c.data}).catch(c=>{console.log(c),alert("err")})},confirmJoin(){const s={userId:parseInt(this.userId,10),activityId:this.activity.id,isCancelled:!1},a=`${y}/orders`;this.$confirm.require({message:`${this.activity.title}`,header:"確認參加",accept:()=>{this.$http.post(a,s).then(()=>{alert("報名成功"),this.reload()}).catch(c=>{console.log(c)})}})},cancelJoin(){const s=this.orders.find(o=>o.userId===parseInt(this.userId,10)),{id:a}=s,c={isCancelled:!0},p=`${y}/orders/${a}`;this.$confirm.require({message:`${this.activity.title}`,header:"確認取消",accept:()=>{this.$http.patch(p,c).then(()=>{alert("取消揪團成功"),this.reload()}).catch(o=>{console.log(o)})}})},changeToZhTW(){this.$primevue.config.locale.accept="確認",this.$primevue.config.locale.reject="取消"}},watch:{$route(s){s.params.id&&(this.getActivityDetail(s.params.id),this.getActivityOrders(s.params.id))}},mounted(){this.getActivityDetail(this.$route.params.id),this.getActivityOrders(this.$route.params.id),this.getActivities(),this.getOrders(),this.userId=this.getUserId(),this.changeToZhTW()}},i=s=>(H("data-v-deebc696"),s=s(),M(),s),Q={class:"pt-[120px] pb-5 md:pt-[92px]"},Y={class:"container"},$={class:"mb-4 text-xl font-bold md:text-3xl"},tt={class:"flex items-center gap-4"},et=i(()=>t("p",null,"主辦者",-1)),st={class:"bg-primary-03 py-10 md:py-20"},it={class:"container"},at={class:"grid h-full grid-cols-12 border-b border-[#3d3d3d] pb-10 md:pb-20"},ct={class:"col-span-12 md:col-span-8"},ot=["src"],nt={class:"mb-4 flex items-center justify-between border-b md:mb-0 md:hidden md:border-0"},rt=i(()=>t("h3",{class:"whitespace-nowrap text-lg font-medium md:mb-8 md:text-xl"}," 揪團詳情 ",-1)),lt={class:"p-4"},dt={class:"flex items-center rounded-full py-1 px-2 text-sm text-[#3D3D3D]"},mt=i(()=>t("span",{class:"material-icons mr-1 text-primary-01"}," schedule ",-1)),ht={class:"flex items-center rounded-full py-1 px-2 text-sm text-[#3D3D3D]"},_t=i(()=>t("span",{class:"material-icons text-primary-01"}," room ",-1)),pt={class:"pl-8 text-sm text-[#b7b7b7]"},ut={class:"mb-10 md:mb-20"},bt={class:"mb-10 flex justify-evenly border-y border-[#3d3d3d] py-10 md:mb-20"},yt={class:"text-center"},vt=i(()=>t("span",{class:"material-symbols-outlined text-4xl"}," credit_card ",-1)),xt={class:"text-center"},ft=i(()=>t("span",{class:"material-symbols-outlined text-4xl"}," monetization_on ",-1)),gt={class:"text-center"},wt=i(()=>t("span",{class:"material-symbols-outlined text-4xl"}," group ",-1)),At={class:"flex flex-wrap gap-4"},Dt={class:"flex flex-col justify-evenly gap-2 md:flex-row"},It=["src"],Jt={class:"mb-10 flex flex-col gap-8 md:mb-20"},Tt={class:"flex gap-4"},kt=i(()=>t("div",{class:"w-full rounded-lg bg-white p-4"},[t("p",{class:"mb-2 text-sm"},"Annie"),t("p",{class:"mb-4"},"請問租借球拍的費用是多少呢?"),t("div",{class:"mb-2 flex text-sm"},[t("span",{class:"mr-2"},"B1"),t("span",{class:"mr-2"},"4 小時前"),t("a",{href:"#",class:"text-[#b7b7b7]"},"回覆")]),t("a",{href:"#",class:"text-sm text-[#b1b1b1]"},"— 查看其他 1 則留言")],-1)),Vt={class:"flex gap-4"},jt=i(()=>t("div",{class:"w-full rounded-lg bg-white p-4"},[t("p",{class:"mb-2 text-sm"},"Annie"),t("p",{class:"mb-4"},"請問租借球拍的費用是多少呢?"),t("div",{class:"mb-2 flex text-sm"},[t("span",{class:"mr-2"},"B1"),t("span",{class:"mr-2"},"4 小時前"),t("a",{href:"#",class:"text-[#b7b7b7]"},"回覆")]),t("a",{href:"#",class:"text-sm text-[#b1b1b1]"},"— 查看其他 1 則留言")],-1)),Ct=i(()=>t("p",{class:"mb-4"},"留言",-1)),Ot=i(()=>t("div",{class:"flex justify-end gap-4"},[t("button",{type:"button",class:"btn bg-white transition-colors hover:bg-primary-02"}," 取消 "),t("button",{type:"button",class:"btn bg-primary-04 transition-colors hover:bg-primary-02"}," 確認 ")],-1)),Et={class:"pt-10"},Pt=i(()=>t("h3",{class:"mb-8 text-xl font-medium"},"更多揪團活動",-1)),St={class:"grid grid-cols-2 gap-6"},Lt={class:"sticky bottom-0 z-30 bg-white py-5"},Bt={class:"container"},Rt={class:"flex flex-col items-center md:flex-row md:justify-between"},zt={class:"mb-2 md:mb-0"},Ut={class:"mb-2 flex items-center md:mb-0"},Nt=i(()=>t("span",{class:"material-symbols-outlined mr-1 text-primary-01"}," calendar_month ",-1)),Wt=i(()=>t("span",{class:"material-icons ml-2 mr-1 text-primary-01"}," schedule ",-1)),Ft={class:"text-lg font-semibold sm:text-xl"},Ht={class:"flex items-center gap-6"},Mt=i(()=>t("a",{href:"#"},[t("i",{class:"pi pi-star text-lg"})],-1)),qt=i(()=>t("button",{type:"button",class:"btn btn-primary py-4 hover:bg-primary-01 hover:text-white",disabled:""}," 主辦者 ",-1)),Zt=i(()=>t("button",{type:"button",class:"btn border border-primary-01 py-4 hover:bg-primary-01 hover:text-white"}," 取消此揪團 ",-1)),Gt=i(()=>t("button",{type:"button",class:"btn btn-primary py-4 hover:bg-primary-01 hover:text-white",disabled:""}," 已參加 ",-1));function Xt(s,a,c,p,o,e){var g,w,A,D,I,J,T,k,V;const O=m("front-header"),v=m("PAvatar"),E=m("JoinAttendees"),x=m("TabPanel"),P=m("PTextarea"),S=m("TabView"),L=m("JoinDetailAside"),B=m("join-card-row"),R=m("RouterLink"),z=m("ConfirmDialog");return h(),d(_,null,[l(O),t("section",Q,[t("div",Y,[t("h2",$,r(e.newDateActivity.title),1),t("div",tt,[l(v,{image:(w=(g=e.newDateActivity)==null?void 0:g.user)==null?void 0:w.img,size:"xlarge",shape:"circle"},null,8,["image"]),t("div",null,[et,t("p",null,r((D=(A=e.newDateActivity)==null?void 0:A.user)==null?void 0:D.name),1)])])])]),t("main",st,[t("div",it,[t("div",at,[t("div",ct,[t("img",{src:e.newDateActivity.mainImg,alt:"JoinDetailImage",class:"rounded md:mb-10"},null,8,ot),t("section",nt,[rt,t("div",lt,[t("p",dt,[mt,b(r((I=e.newDateActivity)==null?void 0:I.date)+" "+r((T=(J=e.newDateActivity)==null?void 0:J.startTime)==null?void 0:T.time),1)]),t("p",ht,[_t,b(r(e.newDateActivity.location),1)]),t("span",pt,r(e.newDateActivity.address),1)])]),t("article",ut,r(e.newDateActivity.content),1),t("section",bt,[t("div",yt,[vt,t("p",null,r(e.newDateActivity.paymentMethod),1)]),t("div",xt,[ft,t("p",null,"$ "+r(e.newDateActivity.cost),1)]),t("div",gt,[wt,t("p",null,r(e.newDateActivity.maxJoinNum)+" 人",1)])]),l(S,null,{default:u(()=>[l(x,{header:"參與者"},{default:u(()=>[t("ul",At,[(h(!0),d(_,null,f(o.orders,n=>(h(),d("li",{key:n.userId},[l(E,{user:n},null,8,["user"])]))),128))])]),_:1}),l(x,{header:"更多照片"},{default:u(()=>[t("div",Dt,[(h(!0),d(_,null,f(e.newDateActivity.imgs,(n,U)=>(h(),d("div",{class:"w-full",key:n+U},[t("img",{src:n,alt:"JoinDetailImg",class:"h-full"},null,8,It)]))),128))])]),_:1}),l(x,{header:"留言"},{default:u(()=>[t("ul",Jt,[t("li",Tt,[t("div",null,[l(v,{image:"/src/assets/images/avatar/avatar01.png",size:"xlarge",shape:"circle",class:"mb-2"})]),kt]),t("li",Vt,[t("div",null,[l(v,{image:"/src/assets/images/avatar/avatar01.png",size:"xlarge",shape:"circle",class:"mb-2"})]),jt])]),t("div",null,[Ct,t("form",null,[l(P,{modelValue:o.textareaValue,"onUpdate:modelValue":a[0]||(a[0]=n=>o.textareaValue=n),rows:"5",class:"mb-2 w-full",placeholder:"留下您的想法"},null,8,["modelValue"]),Ot])])]),_:1})]),_:1})]),l(L,{activity:e.newDateActivity},null,8,["activity"])]),t("section",Et,[Pt,t("ul",St,[(h(!0),d(_,null,f(e.slicedActivities,n=>(h(),d("li",{class:"col-span-1",key:n.id},[l(R,{class:"h-full",to:`/JoinDetail/id=${n.id}`},{default:u(()=>[l(B,{activity:n,userId:o.userId},null,8,["activity","userId"])]),_:2},1032,["to"])]))),128))])])])]),t("section",Lt,[t("div",Bt,[t("div",Rt,[t("div",zt,[t("p",Ut,[Nt,b(" "+r(e.newDateActivity.date)+" "+r(e.newDateActivity.dayOfWeekText)+" ",1),Wt,b(" "+r((V=(k=e.newDateActivity)==null?void 0:k.startTime)==null?void 0:V.time),1)]),t("h2",Ft,r(e.newDateActivity.title),1)]),t("div",Ht,[t("p",null,r(e.newDateActivity.maxJoinNum-o.orders.length)+" 個空位 ",1),Mt,e.isHost?(h(),d(_,{key:0},[qt,Zt],64)):e.hadJoined?(h(),d(_,{key:1},[Gt,t("button",{type:"button",class:"btn border border-primary-01 py-4 hover:bg-primary-01 hover:text-white",onClick:a[1]||(a[1]=(...n)=>e.cancelJoin&&e.cancelJoin(...n)),label:"cancel"}," 取消報名 ")],64)):(h(),d("button",{key:2,type:"button",class:"btn btn-primary py-4",onClick:a[2]||(a[2]=(...n)=>e.confirmJoin&&e.confirmJoin(...n)),label:"confirm"}," 我要參加 "))])])])]),l(z)],64)}const ce=N(K,[["render",Xt],["__scopeId","data-v-deebc696"]]);export{ce as default};
