import{I as d,J as o,S as c}from"./index-d1e468b9.js";const{VITE_URL:p}={VITE_URL:"https://joinsport-server-render.onrender.com",VITE_PATH:"key0329",VITE_TEXT:"這是產品的環境",VITE_MAP_KEY:"AIzaSyAScKOJBsEFvLrg4YGx5ticXsBzFYZPATw",VITE_MAP_URL:"https://maps.googleapis.com/maps/api/geocode/json",BASE_URL:"/JoinSport/",MODE:"production",DEV:!1,PROD:!0},l=d("joinActivities",{state:()=>({activitiesList:[],orders:[],currentPage:1,pageLimit:6,isLoading:!0}),getters:{restructureActivitiesList(){const t=[];return this.activitiesList.forEach(i=>{const e=i.date.split("-"),s=`${e[1]}/${e[2]}`;t.push({...i,date:s,participants:[],numParticipants:0,participantsId:[],originDate:i.date})}),this.orders.forEach(({user:i,activity:e})=>{const s=e==null?void 0:e.id,a=i.img,n=i.id;t[s-1]=t[s-1]||{participants:[],participantsId:[]},t[s-1].participants.push(a),t[s-1].numParticipants=t[s-1].participants.length,t[s-1].participantsId.push(n)}),t.map(i=>({...i,participants:i.participants.slice(0,3)}))},availableActivities(){return this.restructureActivitiesList.map(i=>{const e=new Date(i.originDate).getTime(),s=i;return s.originDate=e,s}).filter(i=>{const e=new Date().getTime();return i.originDate>e})}},actions:{getActivities(){const t=`${p}/activities`;o.get(t).then(r=>{this.activitiesList=r.data,this.isLoading=!1}).catch(r=>{c.fire({position:"top-end",icon:"error",title:r.response.message,showConfirmButton:!1,timer:1500})})},getOrders(){const t=`${p}/orders?isCancelled=false&_expand=activity&_expand=user`;o.get(t).then(r=>{this.orders=r.data}).catch(r=>{c.fire({position:"top-end",icon:"error",title:r.response.message,showConfirmButton:!1,timer:1500})})},changePage(t=1){this.currentPage=t},arrangePage(t){const r=(this.currentPage-1)*this.pageLimit,i=this.currentPage*this.pageLimit,e=t.slice(r,i),s=t.filter(g=>g.isCancelled===!1),a=Math.ceil(s.length/this.pageLimit);return{list:e,pageTotal:a}}}});export{l as j};
